// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Categoria {
  id               Int       @id @default(autoincrement())
  nombreCategoria  String
  eventos          Evento[]
}

model Organizacion {
  idOrganizacion  Int      @id @default(autoincrement())
  ubicacion       String
  mail            String   @unique
  nombre          String
  quit            String
  contraseña      String
  eventos         Evento[]
}

model Evento {
  idEvento        Int        @id @default(autoincrement())
  nombre          String
  fechaCreacion   DateTime
  fechaHoraEvento DateTime
  capacidadMax    Int
  descripcion     String?
  idCategoria     Int
  idOrganizacion  Int

  categoria       Categoria @relation(fields: [idCategoria], references: [id])
  organizacion    Organizacion @relation(fields: [idOrganizacion], references: [idOrganizacion])
  tipoTickets     TipoTicket[]
}

model TipoTicket {
  idTipoTicket    Int       @id @default(autoincrement())
  tipo            String
  precio          Decimal
  acceso          String
  cantMaxPorTipo  Int
  idEvento        Int

  evento          Evento    @relation(fields: [idEvento], references: [idEvento])
  tickets         Ticket[]
}

model Cliente {
  idCliente       Int       @id @default(autoincrement())
  contraseña      String
  nombre          String
  apellido        String
  tipoDoc         String
  nroDoc          String   @unique
  fechaNacimiento DateTime
  mail            String   @unique

  tickets         Ticket[]
}

model Ticket {
  nroTicket       Int       @id @default(autoincrement())
  fechaCreacion   DateTime
  estado          String
  tokenQr         String   @unique
  idTipoTicket    Int
  idCliente       Int

  tipoTicket      TipoTicket @relation(fields: [idTipoTicket], references: [idTipoTicket])
  cliente         Cliente    @relation(fields: [idCliente], references: [idCliente])
}

model Politica {
  fechaVigencia   DateTime @id
  tiempoReembolso Int
}
